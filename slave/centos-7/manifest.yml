images:
- name: buildslave-centos-7-zfs-head
  base-ami: ami-c7d092f7
  size: t2.medium
  username: centos
  deploy:
    file: cloud-init-base.sh
  # Fedora 20 doesn't allow sudo without a terminal by default, so enable it.
  userdata: "#!/bin/sh\nsed -i '/Defaults    requiretty/d' /etc/sudoers"

- name: buildslave-centos-7
  base-ami: buildslave-centos-7-zfs-head
  size: t2.medium
  deploy:
    # We need a new enough version of zfs to work on 3.17.
    script: |-
      SPL_VERSION=0.6.3-52_g52479ec.el7.centos
      ZFS_VERSION=0.6.3-159_gc944be5.el7.centos
      sudo yum --enablerepo=zfs-testing --disablerepo=zfs install -y spl-${SPL_VERSION} spl-dkms-${SPL_VERSION} zfs-${ZFS_VERSION} libnvpair1-${ZFS_VERSION} libuutil1-${ZFS_VERSION} libzfs2-${ZFS_VERSION} libzpool2-${ZFS_VERSION} zfs-dkms-${ZFS_VERSION}
  username: centos
